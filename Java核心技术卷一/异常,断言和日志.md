# 异常,断言和日志

目的

- 向用户通告错误
- 保存所有工作结果
- 允许用户以妥善的形式退出程序.

## 处理错误

### 异常分类

异常对象派生于Throwable类.

Throwable下层分为 Error 和 Exception.

Error 类层次结构描述了Java运行时系统的内部错误和资源耗尽错误.

Exception 分解为 RuntimeException 和 IOException. 前者包含程序错误导致的异常.例如

- 错误的类型转换
- 数组访问越界
- 访问null指针

后者包含

- 试图在文件尾部后面读取数据
- 试图打开一个不存在的文件

Java语言规范将派生于Error类和RuntimeException类的所有异常称为**非受查(unchecked)异常**,其他所有异常称为**受查异常**.

### 声明受查异常

声明异常会通知编译器该代码可能会抛出 某一类的异常.方法应在其首部声明所有可能抛出的异常.

``` java
public FileInputStream(String name) throws FileNotFoundException
```

自己编写方法,不必将所有可能抛出的异常进行声明,以下情况时应抛出异常:

- 调用一个抛出受查异常的方法.
- 运行过程中发现错误
- 程序出现错误
- Java虚拟机和运行库出现的内部错误.

如果一个方法有可能抛出多个受查异常类型,多个异常类之间用逗号隔开.

**子类方法中声明的受查异常不能比超类方法中声明的异常更通用**,**如果超类方法没有抛出任何受查异常,子类也不能抛出任何受查异常**.

## 捕获异常

捕获异常使用 `try/catch` 语句块

```java
try{
    //code
}catch(Exception){
    //handler for this type
}
```

如果try语句中任何代码抛出了一个在catch子句中说明的异常类

- 程序将跳过try语句块的其余代码
- 程序将执行catch子句中的处理器代码

通常,应该捕获知道如何处理的异常,将不知道怎样处理的异常进行传递.

对于多个异常,可以为每个异常类型使用一个单独的catch子句.

### finally子句

不管是否有异常被捕获,finally子句中的代码都将被执行.

## 使用异常机制的技巧

- 不能代替简单的测试,只在异常情况下使用异常机制.
- 不要过分细化异常.
- 利用异常层次结构.
- 早抛出,晚捕获.

